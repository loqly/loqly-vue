(function(s,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],r):(s=typeof globalThis<"u"?globalThis:s||self,r(s.LoqlyVue={},s.Vue))})(this,(function(s,r){"use strict";const d=async(n,t=null,e={})=>{if(!n)throw new Error("API key is required");let a="";t&&Object.keys(t).length>0&&(t.projectIds&&(a+=`projectIds=${t.projectIds.join(",")}&`),t.namespaces&&(a+=`namespaces=${t.namespaces.join(",")}&`),t.languages&&(a+=`languages=${t.languages.join(",")}`));let l=e;try{const o=window.location.href.includes("http://localhost")?"http://localhost:3000":"https://api.loqly.dev",u=await fetch(`${o}/v1/strings?${a}`,{method:"GET",headers:{Authorization:`Apikey ${n}`,"Content-Type":"application/json"}}),i=await u.json();if(!u.ok||i.error)throw new Error(i.error||"Something went wrong, please try again.");i.strings&&(l=i.strings)}catch(o){throw new Error(o)}finally{return l}};function f(n,t){if(!t)return n;const e=/\{([^\s{}]+)\}/g;return[...n.matchAll(e)].map(a=>a[1]).reduce((a,l)=>l in t?a.replace(new RegExp(`\\{${l}\\}`,"g"),t[l]):a,n)}class h{constructor({apiKey:t,defaultLocale:e="en"}){this.apiKey=t,this.this._defaultLocale=e,this._locale=e,this._translations=null,this._translatableElements=[]}async init(){this._translations=await d(this.apiKey),this.cacheElements(),this.translateElements(this._translatableElements)}static async getTranslations(t,e=null,a={}){return await d(t,e,a)}static interpolateTranslation(t,e=null){return f(t,e)}t(t,e=null){var a,l,o,u;const i=((l=(a=this._translations)==null?void 0:a[t])==null?void 0:l[this._locale])||((u=(o=this._translations)==null?void 0:o[t])==null?void 0:u[this._defaultLocale]);return f(i||t,e)}cacheElements(){this._translatableElements=Array.from(document.querySelectorAll("[data-t]"))}translateElements(t){t.forEach(e=>{const a=e.getAttribute("data-t");a&&(e.textContent=this.t(a))})}translatePage(){this._translatableElements.length||this.cacheElements(),this.translateElements(this._translatableElements)}updateLanguage(t){this._locale=t,this.translatePage()}get translations(){return this._translations}set translations(t){this._translations=t}get locale(){return this._locale}set locale(t){this._locale=t}get defaultLocale(){return this._defaultLocale}set defaultLocale(t){this._defaultLocale=t}}const c=r.reactive({locale:"en",defaultLocale:"en",translations:{}}),g=(n,t=null)=>{var l,o,u,i;const e=r.ref((o=(l=c.translations)==null?void 0:l[n])==null?void 0:o[c.locale]);return e.value||r.ref((i=(u=c.translations)==null?void 0:u[n])==null?void 0:i[c.defaultLocale]).value?h.interpolateTranslation(e.value,t):h.interpolateTranslation(n,t)},p=()=>{const n=r.getCurrentInstance();return{updateLanguage:e=>{c.locale=e,n.proxy.$forceUpdate()}}},m={install:(n,{translations:t={},defaultLocale:e="en",func:a="$t"}={})=>{c.translations=t,c.locale=e,c.locale=e,n.config.globalProperties[a]=g}},_=h.getTranslations;s.default=m,s.getTranslations=_,s.translate=g,s.useLoqly=p,Object.defineProperties(s,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
